poly_1 = [-5.54922106033353e-001    1.70072974493571e+000
-5.54922106033353e-001    1.70072974493571e+000
-4.84791206476521e-001    1.67534249232978e+000
-4.07598437963366e-001    1.67522054482818e+000
-3.30416755586720e-001    1.66877949951637e+000
-2.81338429260749e-001    1.64342550531996e+000
-2.11274046522972e-001    1.58012366585276e+000
-1.69246503016815e-001    1.53582346436223e+000
-1.55333401697842e-001    1.46629121617689e+000
-1.13239341372630e-001    1.45990560154762e+000
-4.30862695427801e-002    1.44715654456211e+000
 4.80306864258573e-002    1.38382144668538e+000
 1.18117241436652e-001    1.33315780283861e+000
 2.23280332362373e-001    1.27611963049907e+000
 2.16140860450485e-001    1.20662064072326e+000
 2.16052171358412e-001    1.15606785824157e+000
 2.93122992369967e-001    1.08643583482765e+000
 3.56169850697456e-001    1.02314508149696e+000
 3.77122648699735e-001    9.66239942795536e-001
 3.97975671473431e-001    8.52462923802212e-001
 3.90747510469470e-001    7.32411151544714e-001
 3.76546169601260e-001    6.37646856664570e-001
 3.97521139876556e-001    5.93379913583566e-001
 4.46477518700926e-001    4.98515843474839e-001
 4.46300140516780e-001    3.97410278511464e-001
 4.04039788143931e-001    3.09009425987567e-001
 3.96977919187608e-001    2.83744120883232e-001
 3.19696461582380e-001    2.33313285903146e-001
 2.21329172336763e-001    1.63958415901954e-001
 1.58093849688618e-001    1.19824506459060e-001
 6.67662571263072e-002    6.30967459417811e-002
-2.44948186169491e-002    4.42835722857673e-002
-5.95824406683831e-002    4.43390029683131e-002
-1.29768770907761e-001    3.81307665231936e-002
-1.64900737505231e-001    1.29098059648958e-002
-1.93081696511470e-001   -5.02368275911766e-002
-2.00276599105903e-001   -1.51331306418041e-001
-1.79368145649661e-001   -2.33512836360311e-001
-2.07571276928918e-001   -3.09297665536804e-001
-2.35685719116102e-001   -3.34529712231612e-001
-3.26968967132377e-001   -3.65981081508047e-001
-3.97210728054300e-001   -4.03784807004221e-001
-4.95533672753879e-001   -4.47863285764569e-001
-6.28811205866783e-001   -4.16057160119841e-001
-6.77967135148319e-001   -4.34936850594910e-001
-7.06125921881539e-001   -4.85445288530560e-001
-7.06380903021249e-001   -6.30784538165411e-001
-8.25667731859616e-001   -6.24276976034544e-001
-9.09889110919567e-001   -6.30463040206646e-001
-1.05742341558323e+000   -7.25016698493117e-001
-1.16259759264546e+000   -6.74297623963793e-001
-1.35197097649462e+000   -6.17126417986148e-001
-1.46428462546874e+000   -6.35906333232634e-001
-1.63270521131562e+000   -6.35640265956415e-001
-1.74483039596908e+000   -5.46995518429316e-001
-1.80073778238468e+000   -4.14205775322814e-001
-1.74439803664522e+000   -3.00550703831092e-001
-1.73715878950475e+000   -1.74179833763383e-001
-1.77907547164582e+000   -6.66886541707432e-002
-1.79986197760046e+000    8.50029516838458e-002
-1.82779904160350e+000    1.60876469952413e-001
-1.80655800405198e+000    2.68267874316471e-001
-1.74321182003875e+000    3.75592761861473e-001
-1.58164246655451e+000    4.70124247874926e-001
-1.59558882628301e+000    5.20699202629632e-001
-1.44101482493605e+000    6.27879970400016e-001
-1.28651842654465e+000    6.90827053498923e-001
-1.23030062830679e+000    7.34972049078326e-001
-1.21612145971159e+000    8.17098148338050e-001
-1.25102061744237e+000    9.24578241794180e-001
-1.25074346402964e+000    1.08255568704945e+000
-1.25054391357248e+000    1.19629944763325e+000
-1.22935830670351e+000    1.27209536294625e+000
-1.15196598773319e+000    1.38571717602845e+000
-1.11668990136110e+000    1.49308640811949e+000
-1.02517384447813e+000    1.65723883141035e+000
-9.05842671093731e-001    1.67600766052033e+000
-7.37344482291283e-001    1.71997527791558e+000
-6.32081616136980e-001    1.71980898586795e+000
 ];

poly_2 = [
 6.42358464680955e-001    1.50655052090984e-001
 7.75757945295459e-001    1.88359002358576e-001
 8.53006144491160e-001    2.19832543908030e-001
 9.51262572371685e-001    2.25996435807112e-001
 1.06358730748231e+000    2.51095448863810e-001
 1.21092206168881e+000    2.31905346566485e-001
 1.36527434030559e+000    2.12704158132651e-001
 1.48449465232490e+000    1.68282009140520e-001
 1.58966882938713e+000    1.17562934611195e-001
 1.63865846662103e+000    4.16561579331005e-002
 1.68761484544540e+000   -5.32079121756266e-002
 1.71550756490240e+000   -1.54357821685037e-001
 1.73638275994911e+000   -2.55496645057939e-001
 1.75723578272281e+000   -3.69273664051262e-001
 1.75716926590376e+000   -4.07188250912528e-001
 1.75702514612914e+000   -4.89336522445269e-001
 1.71476479375629e+000   -5.77737374969167e-001
 1.65845830642636e+000   -6.72435153030257e-001
 1.56709745545452e+000   -7.48120206978169e-001
 1.53897192713082e+000   -7.79671351483187e-001
 1.46875233848192e+000   -8.04836881358939e-001
 1.40551701583377e+000   -8.48970790801832e-001
 1.27212862135578e+000   -8.80355643259213e-001
 1.11768765364692e+000   -9.11707237307066e-001
 1.00545160762837e+000   -8.86253467882077e-001
 9.21274573114456e-001   -8.67163140813334e-001
 8.37141883146578e-001   -8.22796422503749e-001
 7.10870788307452e-001   -7.97320480805740e-001
 5.84655124150871e-001   -7.40249050056678e-001
 5.63802101377175e-001   -6.26472031063354e-001
 5.28858599100360e-001   -5.44268328848067e-001
 5.00999138052886e-001   -4.24161125908024e-001
 4.73150763141922e-001   -2.97734825157770e-001
 4.94458317512493e-001   -1.52428833932447e-001
 5.15721527337027e-001   -3.23992339479673e-002
 5.36951478752034e-001    6.86730726058795e-002
];

poly_3 = [1.07530535377247e+000   -1.06961816574328e+000
 1.11721094977703e+000   -1.18342844314613e+000
 1.18726424637830e+000   -1.25304938042355e+000
 1.22224100706464e+000   -1.31629578920820e+000
 1.20104431405916e+000   -1.39841080233141e+000
 1.21493524310512e+000   -1.48058124613717e+000
 1.19372746396313e+000   -1.56901535707060e+000
 1.12334158326659e+000   -1.68896735409951e+000
 1.03198073229475e+000   -1.76465240804743e+000
 9.40752914961018e-001   -1.76450828827281e+000
 8.49392063989180e-001   -1.84019334222072e+000
 7.65048737427628e-001   -1.91588948230514e+000
 5.96672496126781e-001   -1.89034702378808e+000
 5.05489023339089e-001   -1.86492651277262e+000
 3.93230805047518e-001   -1.85211093896805e+000
 2.88012283439252e-001   -1.82666825567957e+000
 1.89911061469855e-001   -1.74436477823570e+000
 1.05844888321033e-001   -1.66208347306485e+000
 2.87851534459871e-002   -1.58613235184071e+000
-2.01712253783837e-002   -1.49126828173199e+000
 6.41055843641132e-002   -1.45348672850883e+000
 5.02368275911764e-002   -1.35867808908265e+000
 2.22997635881388e-002   -1.28280457081408e+000
 1.06510056511581e-001   -1.28293760445219e+000
 1.48759322747920e-001   -1.20085584973851e+000
 1.48892356386030e-001   -1.12502667601598e+000
 1.84101925939065e-001   -1.05557203078620e+000
 2.61327952861747e-001   -1.03673668485717e+000
 3.45504987375662e-001   -1.05582701192591e+000
 4.36688460163354e-001   -1.08124752294137e+000
 4.99957041221027e-001   -1.01815632006785e+000
 5.77271757235783e-001   -9.48768191657128e-001
 6.68488488433002e-001   -9.55231409241958e-001
 7.73673751631741e-001   -9.99631385961071e-001
 8.43760306642536e-001   -1.05029502980785e+000
 9.06973457017663e-001   -1.01879931598538e+000
 9.63124738436467e-001   -1.01256890726724e+000
 ];


for i = 1:size(Elem,1)
    cen = elem_centroid(i,:);
    cond = inpolygon(cen(1),cen(2),poly_1(:,1),poly_1(:,2)) ||...
           inpolygon(cen(1),cen(2),poly_2(:,1),poly_2(:,2)) ||...
           inpolygon(cen(1),cen(2),poly_3(:,1),poly_3(:,2));
       if cond == 1
           vol_frac(i,1) = 0.8;
       end
end
